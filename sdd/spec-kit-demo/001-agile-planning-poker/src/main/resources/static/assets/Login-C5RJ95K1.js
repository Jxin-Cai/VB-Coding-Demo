import{_ as V,u as C,r as c,c as B,o as v,a as o,b as l,w as s,d as n,e as z,f as d,g as k,h as E,i as L,j as R,k as U,t as I,E as m,l as M}from"./index-Gyt2orIW.js";import{a as P}from"./index-Bh12ySJS.js";const j={class:"login-container"},q={class:"card-header"},D={class:"tips"},F={__name:"Login",setup(W){const b=M(),_=C(),u=c(null),t=c(!1),r=c({name:""}),y={name:[{required:!0,message:"è¯·è¾“å…¥å§“å",trigger:"blur"},{min:2,max:20,message:"å§“åé•¿åº¦åœ¨ 2 åˆ° 20 ä¸ªå­—ç¬¦",trigger:"blur"}]},p=async()=>{u.value&&await u.value.validate(async f=>{if(f){t.value=!0;try{const e=await P.login(r.value.name);console.log("ç™»å½•å“åº”:",e),console.log("sessionToken:",e.data.sessionToken),console.log("userName:",e.data.userName);const i=e.data.userName||r.value.name,a=e.data.sessionToken;if(!a){console.error("åç«¯æœªè¿”å›sessionToken!"),m.error("ç™»å½•å¤±è´¥ï¼šæœåŠ¡å™¨æœªè¿”å›ä¼šè¯ä»¤ç‰Œ");return}_.login({name:i},a),console.log("ç”¨æˆ·ä¿¡æ¯å·²ä¿å­˜åˆ°store:",_.currentUser),console.log("localStorage user:",localStorage.getItem("user")),m.success("ç™»å½•æˆåŠŸï¼"),b.push("/pools")}catch(e){console.error("ç™»å½•å¤±è´¥:",e),m.error("ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{t.value=!1}}})};return(f,e)=>{const i=n("TrendCharts"),a=n("el-icon"),h=n("el-input"),g=n("el-form-item"),x=n("el-button"),N=n("el-form"),T=n("el-alert"),w=n("el-card");return v(),B("div",j,[o(w,{class:"login-card"},{header:s(()=>[l("div",q,[o(a,{size:32,color:"#667eea"},{default:s(()=>[o(i)]),_:1}),e[1]||(e[1]=l("h2",null,"æ•æ·ä¼°ç‚¹æœåŠ¡",-1)),e[2]||(e[2]=l("p",{class:"subtitle"},"Planning Poker",-1))])]),default:s(()=>[o(N,{model:r.value,rules:y,ref_key:"formRef",ref:u,onSubmit:z(p,["prevent"])},{default:s(()=>[o(g,{prop:"name"},{default:s(()=>[o(h,{modelValue:r.value.name,"onUpdate:modelValue":e[0]||(e[0]=S=>r.value.name=S),placeholder:"è¯·è¾“å…¥æ‚¨çš„å§“å",size:"large",clearable:"","prefix-icon":d(k)},{prepend:s(()=>[o(a,null,{default:s(()=>[o(d(k))]),_:1})]),_:1},8,["modelValue","prefix-icon"])]),_:1}),o(g,null,{default:s(()=>[o(x,{type:"primary",size:"large",loading:t.value,onClick:p,style:{width:"100%"}},{default:s(()=>[t.value?L("",!0):(v(),E(a,{key:0},{default:s(()=>[o(d(U))]),_:1})),R(" "+I(t.value?"ç™»å½•ä¸­...":"è¿›å…¥ä¼°ç‚¹"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),l("div",D,[o(T,{title:"æç¤º",type:"info",closable:!1,"show-icon":""},{default:s(()=>[...e[3]||(e[3]=[l("p",null,"è¾“å…¥æ‚¨çš„å§“åå³å¯è¿›å…¥ç³»ç»Ÿ",-1),l("p",null,"é¦–æ¬¡ä½¿ç”¨ä¼šè‡ªåŠ¨åˆ›å»ºè´¦å·",-1)])]),_:1})])]),_:1}),e[4]||(e[4]=l("div",{class:"footer-info"},[l("p",null,"ğŸ¯ æ”¯æŒå¤šäººå®æ—¶åä½œä¼°ç‚¹"),l("p",null,"ğŸ“Š è‡ªåŠ¨ç»Ÿè®¡åˆ†ææŠ•ç¥¨ç»“æœ"),l("p",null,"ğŸ”„ WebSocket å®æ—¶åŒæ­¥")],-1))])}}},H=V(F,[["__scopeId","data-v-f2b76d21"]]);export{H as default};
